import bpy
import numpy as np

zz = np.array([-4.70643685856882,
-4.70477941934558,
-4.69986739717150,
-4.69166221467842,
-4.68023610621013,
-4.66564238026223,
-4.64775367852932,
-4.62681582246456,
-4.60278270203086,
-4.57568295776093,
-4.54567510722909,
-4.51274641409255,
-4.47698486149991,
-4.43859981958590,
-4.39741558284925,
-4.35389861958411,
-4.30773731211565,
-4.25932147883433,
-4.20871412475980,
-4.15581343445254,
-4.10107865291271,
-4.04430949593365,
-3.98567572788825,
-3.92553643369176,
-3.86365127041401,
-3.80027717189508,
-3.73570906033253,
-3.66972487987398,
-3.60258389610110,
-3.53455583192951,
-3.46544392566739,
-3.39546992049638,
-3.32489668669944,
-3.25356098126158,
-3.18162395384408,
-3.10933812369124,
-3.03659360434408,
-2.96347687843758,
-2.89021417755770,
-2.81676906136448,
-2.74315075033234,
-2.66954434544261,
-2.59598631898039,
-2.52242629491954,
-2.44900482153075,
-2.37579178463569,
-2.30272432650304,
-2.22989261475817,
-2.15736499283728,
-2.08509650587051,
-2.01313010979004,
-1.94151126227915,
-1.87022179894701,
-1.79926668663221,
-1.72865972812062,
-1.65840639474020,
-1.58848032380380,
-1.51886640120412,
-1.44958621172165,
-1.38058004322738,
-1.31182222269675,
-1.24333222932841,
-1.17501077564391,
-1.10686550160742,
-1.03886060452365,
-0.970894155853381,
-0.902999965620082,
-0.835057800724924,
-0.767057704862611,
-0.698932862219902,
-0.630616704158087,
-0.562077947621087,
-0.493240965706555,
-0.424073675027634,
-0.354519436392145,
-0.284546870233127,
-0.214123078070206,
-0.143224823455874,
-0.0718492745492589,
0])

rr = np.array([-4.21806995921287e-24,
0.0735933266265827,
0.147038243855992,
0.220196473627840,
0.292916097776273,
0.365037038546132,
0.436473160442126,
0.507030076731353,
0.576587104894932,
0.645059499878117,
0.712242684348670,
0.778097112579993,
0.842472667959510,
0.905196302047572,
0.966349400623966,
1.02552704388038,
1.08302011226841,
1.13843954088838,
1.19178305830813,
1.24319115611136,
1.29217036245160,
1.33910328382177,
1.38382165395447,
1.42591978744176,
1.46596095330480,
1.50361602823116,
1.53853426026130,
1.57141154546784,
1.60183462770480,
1.62942463262989,
1.65505203035564,
1.67825688707970,
1.69851950199744,
1.71697772532715,
1.73315132473401,
1.74621184374091,
1.75779299907593,
1.76737309707156,
1.77328640607491,
1.77696948402179,
1.77971872717393,
1.78090792135396,
1.77948935824852,
1.77543136139200,
1.77005576543584,
1.76351133496232,
1.75410499919651,
1.74296743659991,
1.73085761115016,
1.71668130408334,
1.70095402389182,
1.68418792110173,
1.66576461160112,
1.64601650290150,
1.62532751761828,
1.60330042379499,
1.58021349282109,
1.55634760264492,
1.53143359590309,
1.50576125285046,
1.47949572756842,
1.45249024224972,
1.42507053598283,
1.39722897525022,
1.36903206971732,
1.34074899544726,
1.31229236055993,
1.28395219626403,
1.25574588910248,
1.22785124405104,
1.20042012172098,
1.17355819301155,
1.14746333164990,
1.12227372694476,
1.09814374150166,
1.07529216034596,
1.05385671110120,
1.03403825350671,
1.01602466690205,
1.00000000014150,
])

cu = bpy.data.curves.new("poly", 'CURVE')
cu.dimensions  = '3D'
bez = cu.splines.new('BEZIER')
# Iteratove over arrays to set pts in right format
pts = [(rr[z],0,zz[z]) for z in range(len(zz))]
flat = [p for pt in pts for p in pt]
s = cu.splines.new('BEZIER')
s.bezier_points.add(len(pts) - 1)
# set the points in one fell swoop
s.bezier_points.foreach_set("co", flat)
# doesn't seem to work for handles so set them in loop
for bp in s.bezier_points:
   bp.handle_left_type = bp.handle_right_type = 'AUTO'

# lazy way to add curve object
bpy.ops.curve.primitive_bezier_curve_add()
ob = bpy.context.object
ob.data = cu

# Spins 360 on z-axis
screw = ob.modifiers.new("Screw", 'SCREW')


